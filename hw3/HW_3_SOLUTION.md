Разворачиваемся предварительно поменяв порт 5000 на 5001 потому что 5000 занят эйрплеем макоси:
![[Pasted image 20251228145524.png]]

Проверяем из чего состоит кластер:
![[Pasted image 20251228145651.png]]
Видим три ноды. 

Подключаемся к веб морде:
![[Pasted image 20251228150127.png]]Видим, что активна одна нода и две реплики, все ок. 

Забиваем данные в базу:
![[Pasted image 20251228151738.png]]

Проверяем, что данные попали в базу:
![[Pasted image 20251228151759.png]]

Запускаем скрипт, данные льются:
![[Pasted image 20251228151944.png]]
![[Pasted image 20251228152010.png]]

Попробуем отключить реплику:
![[Pasted image 20251228152139.png]]
![[Pasted image 20251228152146.png]]
![[Pasted image 20251228152152.png]]
Реплика отключена, данные продолжают литься. Поднимаем реплику и отключаем лидера:
![[Pasted image 20251228152247.png]]![[Pasted image 20251228152254.png]]
![[Pasted image 20251228152321.png]]
Лидер сменился автоматически, скрипт упал, тк закрылось соединение с базой. 

Поднимаем все ноды (при отключении второй реплики при работающем лидере и другой реплике будет поведение аналогичное тому, что наблюдалось ранее), перезапускаем скрипт:
![[Pasted image 20251228152503.png]]
![[Pasted image 20251228152543.png]]

Попробуем отключить ноду etcd:
![[Pasted image 20251228152754.png]]
![[Pasted image 20251228152734.png]]
Все работает. 

Пробуем отключить вторую:
![[Pasted image 20251228152827.png]]
![[Pasted image 20251228152819.png]]
![[Pasted image 20251228152842.png]]Сломалось, мастер нода отвалилась в реплику, данные не пишутся. При потере больше половины нод теряется кворум. Пробуем перезапустить всё:
![[Pasted image 20251228152937.png]]
![[Pasted image 20251228152950.png]]
![[Pasted image 20251228152959.png]]
Кластер ожил, всё работает без необходимости перезапуска. 